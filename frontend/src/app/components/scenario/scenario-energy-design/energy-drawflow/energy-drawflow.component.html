<section
    class="w-90 h-100"
    [ngClass]="{
        'no-data':
            editor && (editor.drawflow.drawflow.Home.data | json) === '{}'
    }"
>
    <div id="drawflow" (drop)="onDrop($event)" (dragover)="allowDrop($event)">
        <div class="gui__empty-text">
            <span> Drag and drop components to build your energy system </span>
            <span>DoubleClick: Opens form to enter parameters</span>
            <span>Middle Mousebutton: Mirror the selected block</span>
        </div>

        <div class="bar-zoom shadow rounded">
            <i class="full-screen" (click)="_toggleFullScreen()"></i>
            <i class="zoom-in" (click)="editor.zoom_in()"></i>
            <i class="zoom-reset" (click)="editor.zoom_reset()"></i>
            <i class="zoom-out" (click)="editor.zoom_out()"></i>
            <i
                class="delete-all"
                title="Delete All"
                (click)="clearGridModel()"
                *ngIf="
                    editor &&
                    (editor.drawflow.drawflow.Home.data | json) !== '{}'
                "
            ></i>
        </div>
    </div>
</section>

<!-- Context Menu -->
<div
    #contextMenu
    id="contextmenu"
    class="border border-2 rounded position-absolute bg-white"
>
    <div class="list-group list-group-flush rounded">
        <div
            class="submenu-parent list-group-item d-flex justify-content-between position-relative"
        >
            <span> Node </span>
            <span> <i class="arrow-right"></i> </span>

            <div
                class="nested-menu list-group position-absolute bg-white border rounded"
            >
                <div
                    class="list-group-item list-group-item-action d-flex justify-content-between"
                    (click)="showModalEdit()"
                >
                    <span> Edit</span>
                    <i class="edit"></i>
                </div>

                <div
                    class="list-group-item list-group-item-action d-flex justify-content-between"
                    (click)="deleteSelectedNode()"
                >
                    <span> Delete</span>
                    <i class="trash"></i>
                </div>
            </div>
        </div>

        <!-- flows -->
        <div
            class="submenu-parent list-group-item d-flex justify-content-between position-relative"
            *ngFor="let item of contextmenu?.nodeConnections?.in; let i = index"
        >
            <span> Flow(in)-{{ item.source.name }} </span>
            <span> <i class="arrow-right"></i> </span>

            <div
                class="nested-menu list-group position-absolute bg-white border rounded"
            >
                <div
                    class="list-group-item list-group-item-action d-flex justify-content-between"
                >
                    <span> Edit</span>
                    <i class="edit"></i>
                </div>

                <div
                    class="list-group-item list-group-item-action d-flex justify-content-between"
                    (click)="deleteFlow(item.source, item.destination)"
                    *ngIf="contextmenu"
                >
                    <span> Delete</span>
                    <i class="trash"></i>
                </div>
            </div>
        </div>

        <div
            class="submenu-parent list-group-item d-flex justify-content-between position-relative"
            *ngFor="let item of contextmenu?.nodeConnections?.out"
        >
            <span> Flow(out)-{{ item.destination.name }}</span>
            <span> <i class="arrow-right"></i> </span>

            <div
                class="nested-menu list-group position-absolute bg-white border rounded"
            >
                <div
                    class="list-group-item list-group-item-action d-flex justify-content-between"
                >
                    <span> Edit</span>
                    <i class="edit"></i>
                </div>

                <div
                    class="list-group-item list-group-item-action d-flex justify-content-between"
                    (click)="deleteFlow(item.source, item.destination)"
                    *ngIf="contextmenu"
                >
                    <span> Delete</span>
                    <i class="trash"></i>
                </div>
            </div>
        </div>
    </div>
</div>
